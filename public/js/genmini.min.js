/*!
*
* MiniKey Generation JS by Carsen Klock for Kronos using CryptoJS
*
* Crypto-JS v2.5.4	Crypto.js
* http://code.google.com/p/crypto-js/
* Copyright (c) 2009-2013, Jeff Mott. All rights reserved.
* http://code.google.com/p/crypto-js/wiki/License
*/
"undefined"!=typeof Crypto&&Crypto.util||function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=window.Crypto={},i=e.util={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&i.rotl(t,8)|4278255360&i.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=i.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],i=0,r=0;i<t.length;i++,r+=8)e[r>>>5]|=(255&t[i])<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],i=0;i<32*t.length;i+=8)e.push(t[i>>>5]>>>24-i%32&255);return e},bytesToHex:function(t){for(var e=[],i=0;i<t.length;i++)e.push((t[i]>>>4).toString(16)),e.push((15&t[i]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(parseInt(t.substr(i,2),16));return e},bytesToBase64:function(e){for(var i=[],r=0;r<e.length;r+=3)for(var o=e[r]<<16|e[r+1]<<8|e[r+2],n=0;n<4;n++)8*r+6*n<=8*e.length?i.push(t.charAt(o>>>6*(3-n)&63)):i.push("=");return i.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var i=[],r=0,o=0;r<e.length;o=++r%4)0!=o&&i.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(e.charAt(r))>>>6-2*o);return i}},r=e.charenc={},o=(r.UTF8={stringToBytes:function(t){return o.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(o.bytesToString(t)))}},r.Binary={stringToBytes:function(t){for(var e=[],i=0;i<t.length;i++)e.push(255&t.charCodeAt(i));return e},bytesToString:function(t){for(var e=[],i=0;i<t.length;i++)e.push(String.fromCharCode(t[i]));return e.join("")}})}()
/*!
* Crypto-JS v2.5.4	SHA256.js
*
*
* http://code.google.com/p/crypto-js/
* Copyright (c) 2009-2013, Jeff Mott. All rights reserved.
* http://code.google.com/p/crypto-js/wiki/License
*/,
/*!
* Crypto-JS v2.5.4	SHA256.js
*
*
* http://code.google.com/p/crypto-js/
* Copyright (c) 2009-2013, Jeff Mott. All rights reserved.
* http://code.google.com/p/crypto-js/wiki/License
*/
function(){var t=Crypto,e=t.util,i=t.charenc,r=i.UTF8,o=i.Binary,n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=t.SHA256=function(t,i){var r=e.wordsToBytes(s._sha256(t));return i&&i.asBytes?r:i&&i.asString?o.bytesToString(r):e.bytesToHex(r)};s._sha256=function(t){t.constructor==String&&(t=r.stringToBytes(t));var i,o,s,u,h,a,p,f,c,l=e.bytesToWords(t),g=8*t.length,y=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],m=[];l[g>>5]|=128<<24-g%32,l[15+(g+64>>9<<4)]=g;for(var d=0;d<l.length;d+=16){i=y[0],o=y[1],s=y[2],u=y[3],h=y[4],a=y[5],p=y[6],f=y[7];for(var v=0;v<64;v++){if(v<16)m[v]=l[v+d];else{var B=m[v-15],b=m[v-2],F=(B<<25|B>>>7)^(B<<14|B>>>18)^B>>>3,T=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;m[v]=F+(m[v-7]>>>0)+T+(m[v-16]>>>0)}var I=i&o^i&s^o&s,w=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22);c=(f>>>0)+((h<<26|h>>>6)^(h<<21|h>>>11)^(h<<7|h>>>25))+(h&a^~h&p)+n[v]+(m[v]>>>0),f=p,p=a,a=h,h=u+c>>>0,u=s,s=o,o=i,i=c+(w+I)>>>0}y[0]+=i,y[1]+=o,y[2]+=s,y[3]+=u,y[4]+=h,y[5]+=a,y[6]+=p,y[7]+=f}return y},s._blocksize=16,s._digestsize=32}(),function(){var t=Crypto,e=t.util,i=t.charenc,r=i.UTF8,o=i.Binary;e.bytesToLWords=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t[i/8])<<i%32;return e},e.lWordsToBytes=function(t){for(var e=[],i=0;i<32*t.length;i+=8)e.push(t[i>>5]>>>i%32&255);return e};var n=t.RIPEMD160=function(t,i){var r=e.lWordsToBytes(n._rmd160(t));return i&&i.asBytes?r:i&&i.asString?o.bytesToString(r):e.bytesToHex(r)};function s(t,e,i,r){return 0<=t&&t<=15?e^i^r:16<=t&&t<=31?e&i|~e&r:32<=t&&t<=47?(e|~i)^r:48<=t&&t<=63?e&r|i&~r:64<=t&&t<=79?e^(i|~r):"rmd160_f: j out of range"}function u(t){return 0<=t&&t<=15?0:16<=t&&t<=31?1518500249:32<=t&&t<=47?1859775393:48<=t&&t<=63?2400959708:64<=t&&t<=79?2840853838:"rmd160_K1: j out of range"}function h(t){return 0<=t&&t<=15?1352829926:16<=t&&t<=31?1548603684:32<=t&&t<=47?1836072691:48<=t&&t<=63?2053994217:64<=t&&t<=79?0:"rmd160_K2: j out of range"}n._rmd160=function(t){t.constructor==String&&(t=r.stringToBytes(t));var i=e.bytesToLWords(t),o=8*t.length;i[o>>5]|=128<<o%32,i[14+(o+64>>>9<<4)]=o;for(var n=1732584193,y=4023233417,m=2562383102,d=271733878,v=3285377520,B=0;B<i.length;B+=16){for(var b,F=n,T=y,I=m,w=d,S=v,E=n,C=y,A=m,q=d,D=v,P=0;P<=79;++P)b=l(g(b=l(b=l(b=l(F,s(P,T,I,w)),i[B+a[P]]),u(P)),f[P]),S),F=S,S=w,w=g(I,10),I=T,T=b,b=l(g(b=l(b=l(b=l(E,s(79-P,C,A,q)),i[B+p[P]]),h(P)),c[P]),D),E=D,D=q,q=g(A,10),A=C,C=b;b=l(y,l(I,q)),y=l(m,l(w,D)),m=l(d,l(S,E)),d=l(v,l(F,C)),v=l(n,l(T,A)),n=b}return[n,y,m,d,v]};var a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],c=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];function l(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function g(t,e){return t<<e|t>>>32-e}}(),
/*!
* End of Crypto.js
*
* BitcoinJS-lib (StartCOIN-ified)
*/
/*!
* Random number generator with ArcFour PRNG
* 
* NOTE: For best results, put code like
* <body onclick='SecureRandom.seedTime();' onkeypress='SecureRandom.seedTime();'>
* in your main HTML document.
* 
* Copyright Tom Wu, bitaddress.org  BSD License.
* http://www-cs-students.stanford.edu/~tjw/jsbn/LICENSE
*/
function(){var t=window.SecureRandom=function(){};if(t.state,t.pool,t.pptr,t.poolSize=256,t.prototype.nextBytes=function(e){var i;for(i=0;i<e.length;++i)e[i]=t.getByte()},t.seedTime=function(){t.seedInt((new Date).getTime())},t.getByte=function(){if(null==t.state){for(t.seedTime(),t.state=t.ArcFour(),t.state.init(t.pool),t.pptr=0;t.pptr<t.pool.length;++t.pptr)t.pool[t.pptr]=0;t.pptr=0}return t.state.next()},t.seedInt=function(e){t.pool[t.pptr++]^=255&e,t.pool[t.pptr++]^=e>>8&255,t.pool[t.pptr++]^=e>>16&255,t.pool[t.pptr++]^=e>>24&255,t.pptr>=t.poolSize&&(t.pptr-=t.poolSize)},t.ArcFour=function(){function t(){this.i=0,this.j=0,this.S=new Array}return t.prototype.init=function(t){var e,i,r;for(e=0;e<256;++e)this.S[e]=e;for(i=0,e=0;e<256;++e)i=i+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[i],this.S[i]=r;this.i=0,this.j=0},t.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]},new t},null==t.pool){var e;if(t.pool=new Array,t.pptr=0,"Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var i=window.crypto.random(32);for(e=0;e<i.length;++e)t.pool[t.pptr++]=255&i.charCodeAt(e)}for(;t.pptr<t.poolSize;)e=Math.floor(65536*Math.random()),t.pool[t.pptr++]=e>>>8,t.pool[t.pptr++]=255&e;t.pptr=0,t.seedTime(),t.seedInt(window.screenX),t.seedInt(window.screenY)}}(),
/*!
* Basic Javascript Elliptic Curve implementation
* Ported loosely from BouncyCastle's Java EC code
* Only Fp curves implemented for now
* 
* Copyright Tom Wu, bitaddress.org  BSD License.
* http://www-cs-students.stanford.edu/~tjw/jsbn/LICENSE
*/
function(){var t=window.EllipticCurve=function(){};t.FieldElementFp=function(t,e){this.x=e,this.q=t},t.FieldElementFp.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},t.FieldElementFp.prototype.toBigInteger=function(){return this.x},t.FieldElementFp.prototype.negate=function(){return new t.FieldElementFp(this.q,this.x.negate().mod(this.q))},t.FieldElementFp.prototype.add=function(e){return new t.FieldElementFp(this.q,this.x.add(e.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.subtract=function(e){return new t.FieldElementFp(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.multiply=function(e){return new t.FieldElementFp(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.square=function(){return new t.FieldElementFp(this.q,this.x.square().mod(this.q))},t.FieldElementFp.prototype.divide=function(e){return new t.FieldElementFp(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},t.FieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},t.FieldElementFp.prototype.sqrt=function(){if(!this.q.testBit(0))throw new Error("even value of q");if(this.q.testBit(1)){var e=new t.FieldElementFp(this.q,this.x.modPow(this.q.shiftRight(2).add(BigInteger.ONE),this.q));return e.square().equals(this)?e:null}var i=this.q.subtract(BigInteger.ONE),r=i.shiftRight(1);if(!this.x.modPow(r,this.q).equals(BigInteger.ONE))return null;var o,n,s=i.shiftRight(2).shiftLeft(1).add(BigInteger.ONE),u=this.x,h=u.shiftLeft(2).mod(this.q);do{var a,p=new SecureRandom;do{a=new BigInteger(this.q.bitLength(),p)}while(a.compareTo(this.q)>=0||!a.multiply(a).subtract(h).modPow(r,this.q).equals(i));var f=t.FieldElementFp.fastLucasSequence(this.q,a,u,s);if(o=f[0],(n=f[1]).multiply(n).mod(this.q).equals(h))return n.testBit(0)&&(n=n.add(this.q)),n=n.shiftRight(1),new t.FieldElementFp(this.q,n)}while(o.equals(BigInteger.ONE)||o.equals(i));return null},t.FieldElementFp.fastLucasSequence=function(t,e,i,r){for(var o=r.bitLength(),n=r.getLowestSetBit(),s=BigInteger.ONE,u=BigInteger.TWO,h=e,a=BigInteger.ONE,p=BigInteger.ONE,f=o-1;f>=n+1;--f)a=a.multiply(p).mod(t),r.testBit(f)?(p=a.multiply(i).mod(t),s=s.multiply(h).mod(t),u=h.multiply(u).subtract(e.multiply(a)).mod(t),h=h.multiply(h).subtract(p.shiftLeft(1)).mod(t)):(p=a,s=s.multiply(u).subtract(a).mod(t),h=h.multiply(u).subtract(e.multiply(a)).mod(t),u=u.multiply(u).subtract(a.shiftLeft(1)).mod(t));p=(a=a.multiply(p).mod(t)).multiply(i).mod(t),s=s.multiply(u).subtract(a).mod(t),u=h.multiply(u).subtract(e.multiply(a)).mod(t),a=a.multiply(p).mod(t);for(f=1;f<=n;++f)s=s.multiply(u).mod(t),u=u.multiply(u).subtract(a.shiftLeft(1)).mod(t),a=a.multiply(a).mod(t);return[s,u]},t.PointFp=function(t,e,i,r,o){this.curve=t,this.x=e,this.y=i,this.z=null==r?BigInteger.ONE:r,this.zinv=null,this.compressed=!!o},t.PointFp.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},t.PointFp.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},t.PointFp.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(BigInteger.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(BigInteger.ZERO))},t.PointFp.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)},t.PointFp.prototype.negate=function(){return new t.PointFp(this.curve,this.x,this.y.negate(),this.z)},t.PointFp.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var i=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(r))return BigInteger.ZERO.equals(i)?this.twice():this.curve.getInfinity();var o=new BigInteger("3"),n=this.x.toBigInteger(),s=this.y.toBigInteger(),u=(e.x.toBigInteger(),e.y.toBigInteger(),r.square()),h=u.multiply(r),a=n.multiply(u),p=i.square().multiply(this.z),f=p.subtract(a.shiftLeft(1)).multiply(e.z).subtract(h).multiply(r).mod(this.curve.q),c=a.multiply(o).multiply(i).subtract(s.multiply(h)).subtract(p.multiply(i)).multiply(e.z).add(i.multiply(h)).mod(this.curve.q),l=h.multiply(this.z).multiply(e.z).mod(this.curve.q);return new t.PointFp(this.curve,this.curve.fromBigInteger(f),this.curve.fromBigInteger(c),l)},t.PointFp.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new BigInteger("3"),i=this.x.toBigInteger(),r=this.y.toBigInteger(),o=r.multiply(this.z),n=o.multiply(r).mod(this.curve.q),s=this.curve.a.toBigInteger(),u=i.square().multiply(e);BigInteger.ZERO.equals(s)||(u=u.add(this.z.square().multiply(s)));var h=(u=u.mod(this.curve.q)).square().subtract(i.shiftLeft(3).multiply(n)).shiftLeft(1).multiply(o).mod(this.curve.q),a=u.multiply(e).multiply(i).subtract(n.shiftLeft(1)).shiftLeft(2).multiply(n).subtract(u.square().multiply(u)).mod(this.curve.q),p=o.square().multiply(o).shiftLeft(3).mod(this.curve.q);return new t.PointFp(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(a),p)},t.PointFp.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,i=t,r=i.multiply(new BigInteger("3")),o=this.negate(),n=this;for(e=r.bitLength()-2;e>0;--e){n=n.twice();var s=r.testBit(e);s!=i.testBit(e)&&(n=n.add(s?this:o))}return n},t.PointFp.prototype.multiplyTwo=function(t,e,i){var r;r=t.bitLength()>i.bitLength()?t.bitLength()-1:i.bitLength()-1;for(var o=this.curve.getInfinity(),n=this.add(e);r>=0;)o=o.twice(),t.testBit(r)?o=i.testBit(r)?o.add(n):o.add(this):i.testBit(r)&&(o=o.add(e)),--r;return o},t.PointFp.prototype.getEncoded=function(e){var i=this.getX().toBigInteger(),r=this.getY().toBigInteger(),o=t.integerToBytes(i,32);return e?r.isEven()?o.unshift(2):o.unshift(3):(o.unshift(4),o=o.concat(t.integerToBytes(r,32))),o},t.PointFp.decodeFrom=function(e,i){i[0];var r=i.length-1,o=i.slice(1,1+r/2),n=i.slice(1+r/2,1+r);o.unshift(0),n.unshift(0);var s=new BigInteger(o),u=new BigInteger(n);return new t.PointFp(e,e.fromBigInteger(s),e.fromBigInteger(u))},t.PointFp.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var i=e.x.subtract(this.x),r=e.y.subtract(this.y).divide(i),o=r.square().subtract(this.x).subtract(e.x),n=r.multiply(this.x.subtract(o)).subtract(this.y);return new t.PointFp(this.curve,o,n)},t.PointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(BigInteger.valueOf(2)),i=this.curve.fromBigInteger(BigInteger.valueOf(3)),r=this.x.square().multiply(i).add(this.curve.a).divide(this.y.multiply(e)),o=r.square().subtract(this.x.multiply(e)),n=r.multiply(this.x.subtract(o)).subtract(this.y);return new t.PointFp(this.curve,o,n)},t.PointFp.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,i=t,r=i.multiply(new BigInteger("3")),o=this.negate(),n=this;for(e=r.bitLength()-2;e>0;--e){n=n.twice();var s=r.testBit(e);s!=i.testBit(e)&&(n=n.add2D(s?this:o))}return n},t.PointFp.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),i=this.curve.getA().toBigInteger(),r=this.curve.getB().toBigInteger(),o=this.curve.getQ(),n=e.multiply(e).mod(o),s=t.multiply(t).multiply(t).add(i.multiply(t)).add(r).mod(o);return n.equals(s)},t.PointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},t.PointFp.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),i=this.getY().toBigInteger();if(e.compareTo(BigInteger.ONE)<0||e.compareTo(t.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(i.compareTo(BigInteger.ONE)<0||i.compareTo(t.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},t.CurveFp=function(e,i,r){this.q=e,this.a=this.fromBigInteger(i),this.b=this.fromBigInteger(r),this.infinity=new t.PointFp(this,null,null)},t.CurveFp.prototype.getQ=function(){return this.q},t.CurveFp.prototype.getA=function(){return this.a},t.CurveFp.prototype.getB=function(){return this.b},t.CurveFp.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},t.CurveFp.prototype.getInfinity=function(){return this.infinity},t.CurveFp.prototype.fromBigInteger=function(e){return new t.FieldElementFp(this.q,e)},t.CurveFp.prototype.decodePointHex=function(e){var i=parseInt(e.substr(0,2),16);switch(i){case 0:return this.infinity;case 2:case 3:var r=1&i,o=e.substr(2,e.length-2),n=new BigInteger(o,16);return this.decompressPoint(r,n);case 4:case 6:case 7:var s=(e.length-2)/2,u=(o=e.substr(2,s),e.substr(s+2,s));return new t.PointFp(this,this.fromBigInteger(new BigInteger(o,16)),this.fromBigInteger(new BigInteger(u,16)));default:return null}},t.CurveFp.prototype.decompressPoint=function(e,i){var r=this.fromBigInteger(i),o=r.multiply(r.square().add(this.getA())).add(this.getB()).sqrt();if(null==o)throw new Error("Invalid point compression");var n=o.toBigInteger();return(n.testBit(0)?1:0)!=e&&(o=this.fromBigInteger(this.getQ().subtract(n))),new t.PointFp(this,r,o,null,!0)},t.fromHex=function(t){return new BigInteger(t,16)},t.integerToBytes=function(t,e){var i=t.toByteArrayUnsigned();if(e<i.length)i=i.slice(i.length-e);else for(;e>i.length;)i.unshift(0);return i},t.X9Parameters=function(t,e,i,r){this.curve=t,this.g=e,this.n=i,this.h=r},t.X9Parameters.prototype.getCurve=function(){return this.curve},t.X9Parameters.prototype.getG=function(){return this.g},t.X9Parameters.prototype.getN=function(){return this.n},t.X9Parameters.prototype.getH=function(){return this.h},t.secNamedCurves={secp256k1:function(){var e=t.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),i=BigInteger.ZERO,r=t.fromHex("7"),o=t.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),n=BigInteger.ONE,s=new t.CurveFp(e,i,r),u=s.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new t.X9Parameters(s,u,o,n)}},t.getSECCurveByName=function(e){return null==t.secNamedCurves[e]?null:t.secNamedCurves[e]()}}(),
/*!
* Basic JavaScript BN library - subset useful for RSA encryption. v1.3
* 
* Copyright (c) 2005  Tom Wu
* All Rights Reserved.
* BSD License
* http://www-cs-students.stanford.edu/~tjw/jsbn/LICENSE
*
* Copyright Stephan Thomas
* Copyright bitaddress.org
*/
function(){var t,e=window.BigInteger=function(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))};function i(){return new e(null)}"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=function(t,e,i,r,o,n){for(var s=32767&e,u=e>>15;--n>=0;){var h=32767&this[t],a=this[t++]>>15,p=u*h+a*s;o=((h=s*h+((32767&p)<<15)+i[r]+(1073741823&o))>>>30)+(p>>>15)+u*a+(o>>>30),i[r++]=1073741823&h}return o},t=30):"Netscape"!=navigator.appName?(e.prototype.am=function(t,e,i,r,o,n){for(;--n>=0;){var s=e*this[t++]+i[r]+o;o=Math.floor(s/67108864),i[r++]=67108863&s}return o},t=26):(e.prototype.am=function(t,e,i,r,o,n){for(var s=16383&e,u=e>>14;--n>=0;){var h=16383&this[t],a=this[t++]>>14,p=u*h+a*s;o=((h=s*h+((16383&p)<<14)+i[r]+o)>>28)+(p>>14)+u*a,i[r++]=268435455&h}return o},t=28),e.prototype.DB=t,e.prototype.DM=(1<<t)-1,e.prototype.DV=1<<t;e.prototype.FV=Math.pow(2,52),e.prototype.F1=52-t,e.prototype.F2=2*t-52;var r,o,n="0123456789abcdefghijklmnopqrstuvwxyz",s=new Array;for(r="0".charCodeAt(0),o=0;o<=9;++o)s[r++]=o;for(r="a".charCodeAt(0),o=10;o<36;++o)s[r++]=o;for(r="A".charCodeAt(0),o=10;o<36;++o)s[r++]=o;function u(t){return n.charAt(t)}function h(t,e){var i=s[t.charCodeAt(e)];return null==i?-1:i}function a(t){var e=i();return e.fromInt(t),e}function p(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function f(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function c(t){for(var e=0;0!=t;)t&=t-1,++e;return e}e.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},e.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0},e.prototype.fromString=function(t,i){var r;if(16==i)r=4;else if(8==i)r=3;else if(256==i)r=8;else if(2==i)r=1;else if(32==i)r=5;else{if(4!=i)return void this.fromRadix(t,i);r=2}this.t=0,this.s=0;for(var o=t.length,n=!1,s=0;--o>=0;){var u=8==r?255&t[o]:h(t,o);u<0?"-"==t.charAt(o)&&(n=!0):(n=!1,0==s?this[this.t++]=u:s+r>this.DB?(this[this.t-1]|=(u&(1<<this.DB-s)-1)<<s,this[this.t++]=u>>this.DB-s):this[this.t-1]|=u<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&e.ZERO.subTo(this,this)},e.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},e.prototype.dlShiftTo=function(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s},e.prototype.drShiftTo=function(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s},e.prototype.lShiftTo=function(t,e){var i,r=t%this.DB,o=this.DB-r,n=(1<<o)-1,s=Math.floor(t/this.DB),u=this.s<<r&this.DM;for(i=this.t-1;i>=0;--i)e[i+s+1]=this[i]>>o|u,u=(this[i]&n)<<r;for(i=s-1;i>=0;--i)e[i]=0;e[s]=u,e.t=this.t+s+1,e.s=this.s,e.clamp()},e.prototype.rShiftTo=function(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)e.t=0;else{var r=t%this.DB,o=this.DB-r,n=(1<<r)-1;e[0]=this[i]>>r;for(var s=i+1;s<this.t;++s)e[s-i-1]|=(this[s]&n)<<o,e[s-i]=this[s]>>r;r>0&&(e[this.t-i-1]|=(this.s&n)<<o),e.t=this.t-i,e.clamp()}},e.prototype.subTo=function(t,e){for(var i=0,r=0,o=Math.min(t.t,this.t);i<o;)r+=this[i]-t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r-=t[i],e[i++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[i++]=this.DV+r:r>0&&(e[i++]=r),e.t=i,e.clamp()},e.prototype.multiplyTo=function(t,i){var r=this.abs(),o=t.abs(),n=r.t;for(i.t=n+o.t;--n>=0;)i[n]=0;for(n=0;n<o.t;++n)i[n+r.t]=r.am(0,o[n],i,n,0,r.t);i.s=0,i.clamp(),this.s!=t.s&&e.ZERO.subTo(i,i)},e.prototype.squareTo=function(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()},e.prototype.divRemTo=function(t,r,o){var n=t.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t)return null!=r&&r.fromInt(0),void(null!=o&&this.copyTo(o));null==o&&(o=i());var u=i(),h=this.s,a=t.s,f=this.DB-p(n[n.t-1]);f>0?(n.lShiftTo(f,u),s.lShiftTo(f,o)):(n.copyTo(u),s.copyTo(o));var c=u.t,l=u[c-1];if(0!=l){var g=l*(1<<this.F1)+(c>1?u[c-2]>>this.F2:0),y=this.FV/g,m=(1<<this.F1)/g,d=1<<this.F2,v=o.t,B=v-c,b=null==r?i():r;for(u.dlShiftTo(B,b),o.compareTo(b)>=0&&(o[o.t++]=1,o.subTo(b,o)),e.ONE.dlShiftTo(c,b),b.subTo(u,u);u.t<c;)u[u.t++]=0;for(;--B>=0;){var F=o[--v]==l?this.DM:Math.floor(o[v]*y+(o[v-1]+d)*m);if((o[v]+=u.am(0,F,o,B,0,c))<F)for(u.dlShiftTo(B,b),o.subTo(b,o);o[v]<--F;)o.subTo(b,o)}null!=r&&(o.drShiftTo(c,r),h!=a&&e.ZERO.subTo(r,r)),o.t=c,o.clamp(),f>0&&o.rShiftTo(f,o),h<0&&e.ZERO.subTo(o,o)}}},e.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},e.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},e.prototype.exp=function(t,r){if(t>4294967295||t<1)return e.ONE;var o=i(),n=i(),s=r.convert(this),u=p(t)-1;for(s.copyTo(o);--u>=0;)if(r.sqrTo(o,n),(t&1<<u)>0)r.mulTo(n,s,o);else{var h=o;o=n,n=h}return r.revert(o)},e.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,r=(1<<e)-1,o=!1,n="",s=this.t,h=this.DB-s*this.DB%e;if(s-- >0)for(h<this.DB&&(i=this[s]>>h)>0&&(o=!0,n=u(i));s>=0;)h<e?(i=(this[s]&(1<<h)-1)<<e-h,i|=this[--s]>>(h+=this.DB-e)):(i=this[s]>>(h-=e)&r,h<=0&&(h+=this.DB,--s)),i>0&&(o=!0),o&&(n+=u(i));return o?n:"0"},e.prototype.negate=function(){var t=i();return e.ZERO.subTo(this,t),t},e.prototype.abs=function(){return this.s<0?this.negate():this},e.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(0!=(e=i-t.t))return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0},e.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+p(this[this.t-1]^this.s&this.DM)},e.prototype.mod=function(t){var r=i();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(e.ZERO)>0&&t.subTo(r,r),r},e.prototype.modPowInt=function(t,e){var i;return i=t<256||e.isEven()?new B(e):new b(e),this.exp(t,i)},e.ZERO=a(0),e.ONE=a(1);var l=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],g=(1<<26)/l[l.length-1];function y(t,e){return t&e}function m(t,e){return t|e}function d(t,e){return t^e}function v(t,e){return t&~e}function B(t){this.m=t}function b(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function F(){}function T(t){this.r2=i(),this.q3=i(),e.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}e.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},e.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),o=a(r),n=i(),s=i(),u="";for(this.divRemTo(o,n,s);n.signum()>0;)u=(r+s.intValue()).toString(t).substr(1)+u,n.divRemTo(o,n,s);return s.intValue().toString(t)+u},e.prototype.fromRadix=function(t,i){this.fromInt(0),null==i&&(i=10);for(var r=this.chunkSize(i),o=Math.pow(i,r),n=!1,s=0,u=0,a=0;a<t.length;++a){var p=h(t,a);p<0?"-"==t.charAt(a)&&0==this.signum()&&(n=!0):(u=i*u+p,++s>=r&&(this.dMultiply(o),this.dAddOffset(u,0),s=0,u=0))}s>0&&(this.dMultiply(Math.pow(i,s)),this.dAddOffset(u,0)),n&&e.ZERO.subTo(this,this)},e.prototype.fromNumber=function(t,i,r){if("number"==typeof i)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),m,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var o=new Array,n=7&t;o.length=1+(t>>3),i.nextBytes(o),n>0?o[0]&=(1<<n)-1:o[0]=0,this.fromString(o,256)}},e.prototype.bitwiseTo=function(t,e,i){var r,o,n=Math.min(t.t,this.t);for(r=0;r<n;++r)i[r]=e(this[r],t[r]);if(t.t<this.t){for(o=t.s&this.DM,r=n;r<this.t;++r)i[r]=e(this[r],o);i.t=this.t}else{for(o=this.s&this.DM,r=n;r<t.t;++r)i[r]=e(o,t[r]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()},e.prototype.changeBit=function(t,i){var r=e.ONE.shiftLeft(t);return this.bitwiseTo(r,i,r),r},e.prototype.addTo=function(t,e){for(var i=0,r=0,o=Math.min(t.t,this.t);i<o;)r+=this[i]+t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r+=t[i],e[i++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[i++]=r:r<-1&&(e[i++]=this.DV+r),e.t=i,e.clamp()},e.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},e.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},e.prototype.multiplyLowerTo=function(t,e,i){var r,o=Math.min(this.t+t.t,e);for(i.s=0,i.t=o;o>0;)i[--o]=0;for(r=i.t-this.t;o<r;++o)i[o+this.t]=this.am(0,t[o],i,o,0,this.t);for(r=Math.min(t.t,e);o<r;++o)this.am(0,t[o],i,o,0,e-o);i.clamp()},e.prototype.multiplyUpperTo=function(t,e,i){--e;var r=i.t=this.t+t.t-e;for(i.s=0;--r>=0;)i[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e);i.clamp(),i.drShiftTo(1,i)},e.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var r=this.t-1;r>=0;--r)i=(e*i+this[r])%t;return i},e.prototype.millerRabin=function(t){var r=this.subtract(e.ONE),o=r.getLowestSetBit();if(o<=0)return!1;var n=r.shiftRight(o);(t=t+1>>1)>l.length&&(t=l.length);for(var s=i(),u=0;u<t;++u){s.fromInt(l[Math.floor(Math.random()*l.length)]);var h=s.modPow(n,this);if(0!=h.compareTo(e.ONE)&&0!=h.compareTo(r)){for(var a=1;a++<o&&0!=h.compareTo(r);)if(0==(h=h.modPowInt(2,this)).compareTo(e.ONE))return!1;if(0!=h.compareTo(r))return!1}}return!0},e.prototype.clone=function(){var t=i();return this.copyTo(t),t},e.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},e.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},e.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},e.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},e.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var i,r=this.DB-t*this.DB%8,o=0;if(t-- >0)for(r<this.DB&&(i=this[t]>>r)!=(this.s&this.DM)>>r&&(e[o++]=i|this.s<<this.DB-r);t>=0;)r<8?(i=(this[t]&(1<<r)-1)<<8-r,i|=this[--t]>>(r+=this.DB-8)):(i=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==o&&(128&this.s)!=(128&i)&&++o,(o>0||i!=this.s)&&(e[o++]=i);return e},e.prototype.equals=function(t){return 0==this.compareTo(t)},e.prototype.min=function(t){return this.compareTo(t)<0?this:t},e.prototype.max=function(t){return this.compareTo(t)>0?this:t},e.prototype.and=function(t){var e=i();return this.bitwiseTo(t,y,e),e},e.prototype.or=function(t){var e=i();return this.bitwiseTo(t,m,e),e},e.prototype.xor=function(t){var e=i();return this.bitwiseTo(t,d,e),e},e.prototype.andNot=function(t){var e=i();return this.bitwiseTo(t,v,e),e},e.prototype.not=function(){for(var t=i(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},e.prototype.shiftLeft=function(t){var e=i();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},e.prototype.shiftRight=function(t){var e=i();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},e.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+f(this[t]);return this.s<0?this.t*this.DB:-1},e.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=c(this[i]^e);return t},e.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},e.prototype.setBit=function(t){return this.changeBit(t,m)},e.prototype.clearBit=function(t){return this.changeBit(t,v)},e.prototype.flipBit=function(t){return this.changeBit(t,d)},e.prototype.add=function(t){var e=i();return this.addTo(t,e),e},e.prototype.subtract=function(t){var e=i();return this.subTo(t,e),e},e.prototype.multiply=function(t){var e=i();return this.multiplyTo(t,e),e},e.prototype.divide=function(t){var e=i();return this.divRemTo(t,e,null),e},e.prototype.remainder=function(t){var e=i();return this.divRemTo(t,null,e),e},e.prototype.divideAndRemainder=function(t){var e=i(),r=i();return this.divRemTo(t,e,r),new Array(e,r)},e.prototype.modPow=function(t,e){var r,o,n=t.bitLength(),s=a(1);if(n<=0)return s;r=n<18?1:n<48?3:n<144?4:n<768?5:6,o=n<8?new B(e):e.isEven()?new T(e):new b(e);var u=new Array,h=3,f=r-1,c=(1<<r)-1;if(u[1]=o.convert(this),r>1){var l=i();for(o.sqrTo(u[1],l);h<=c;)u[h]=i(),o.mulTo(l,u[h-2],u[h]),h+=2}var g,y,m=t.t-1,d=!0,v=i();for(n=p(t[m])-1;m>=0;){for(n>=f?g=t[m]>>n-f&c:(g=(t[m]&(1<<n+1)-1)<<f-n,m>0&&(g|=t[m-1]>>this.DB+n-f)),h=r;0==(1&g);)g>>=1,--h;if((n-=h)<0&&(n+=this.DB,--m),d)u[g].copyTo(s),d=!1;else{for(;h>1;)o.sqrTo(s,v),o.sqrTo(v,s),h-=2;h>0?o.sqrTo(s,v):(y=s,s=v,v=y),o.mulTo(v,u[g],s)}for(;m>=0&&0==(t[m]&1<<n);)o.sqrTo(s,v),y=s,s=v,v=y,--n<0&&(n=this.DB-1,--m)}return o.revert(s)},e.prototype.modInverse=function(t){var i=t.isEven();if(this.isEven()&&i||0==t.signum())return e.ZERO;for(var r=t.clone(),o=this.clone(),n=a(1),s=a(0),u=a(0),h=a(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),i?(n.isEven()&&s.isEven()||(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;o.isEven();)o.rShiftTo(1,o),i?(u.isEven()&&h.isEven()||(u.addTo(this,u),h.subTo(t,h)),u.rShiftTo(1,u)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);r.compareTo(o)>=0?(r.subTo(o,r),i&&n.subTo(u,n),s.subTo(h,s)):(o.subTo(r,o),i&&u.subTo(n,u),h.subTo(s,h))}return 0!=o.compareTo(e.ONE)?e.ZERO:h.compareTo(t)>=0?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h},e.prototype.pow=function(t){return this.exp(t,new F)},e.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var r=e;e=i,i=r}var o=e.getLowestSetBit(),n=i.getLowestSetBit();if(n<0)return e;for(o<n&&(n=o),n>0&&(e.rShiftTo(n,e),i.rShiftTo(n,i));e.signum()>0;)(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),(o=i.getLowestSetBit())>0&&i.rShiftTo(o,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return n>0&&i.lShiftTo(n,i),i},e.prototype.isProbablePrime=function(t){var e,i=this.abs();if(1==i.t&&i[0]<=l[l.length-1]){for(e=0;e<l.length;++e)if(i[0]==l[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<l.length;){for(var r=l[e],o=e+1;o<l.length&&r<g;)r*=l[o++];for(r=i.modInt(r);e<o;)if(r%l[e++]==0)return!1}return i.millerRabin(t)},e.prototype.square=function(){var t=i();return this.squareTo(t),t},e.valueOf=a,e.prototype.toByteArrayUnsigned=function(){var t=this.abs().toByteArray();return t.length?(0==t[0]&&(t=t.slice(1)),t.map(function(t){return t<0?t+256:t})):t},e.fromByteArrayUnsigned=function(t){return t.length?128&t[0]?new e([0].concat(t)):new e(t):t.valueOf(0)},e.prototype.toByteArraySigned=function(){var t=this.abs().toByteArrayUnsigned();return this.compareTo(e.ZERO)<0?128&t[0]?t.unshift(128):t[0]|=128:128&t[0]&&t.unshift(0),t},e.fromByteArraySigned=function(t){return 128&t[0]?(t[0]&=127,e.fromByteArrayUnsigned(t).negate()):e.fromByteArrayUnsigned(t)},B.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},B.prototype.revert=function(t){return t},B.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},B.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},B.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},b.prototype.convert=function(t){var r=i();return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(e.ZERO)>0&&this.m.subTo(r,r),r},b.prototype.revert=function(t){var e=i();return t.copyTo(e),this.reduce(e),e},b.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[i=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},b.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},b.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},F.prototype.convert=function(t){return t},F.prototype.revert=function(t){return t},F.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i)},F.prototype.sqrTo=function(t,e){t.squareTo(e)},T.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=i();return t.copyTo(e),this.reduce(e),e},T.prototype.revert=function(t){return t},T.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},T.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},T.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)}}(),"object"==typeof module?module.exports:window.Bitcoin={},function(t){t.Base58={alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",validRegex:/^[1-9A-HJ-NP-Za-km-z]+$/,base:BigInteger.valueOf(58),encode:function(t){for(var i=BigInteger.fromByteArrayUnsigned(t),r=[];i.compareTo(e.base)>=0;){var o=i.mod(e.base);r.unshift(e.alphabet[o.intValue()]),i=i.subtract(o).divide(e.base)}r.unshift(e.alphabet[i.intValue()]);for(var n=0;n<t.length&&0==t[n];n++)r.unshift(e.alphabet[0]);return r.join("")},decode:function(t){for(var i=BigInteger.valueOf(0),r=0,o=t.length-1;o>=0;o--){var n=e.alphabet.indexOf(t[o]);if(n<0)throw"Invalid character";i=i.add(BigInteger.valueOf(n).multiply(e.base.pow(t.length-1-o))),"1"==t[o]?r++:r=0}for(var s=i.toByteArrayUnsigned();r-- >0;)s.unshift(0);return s}};var e=t.Base58}("undefined"!=typeof Bitcoin?Bitcoin:module.exports),Bitcoin.Address=function(t){"string"==typeof t&&(t=Bitcoin.Address.decodeString(t)),this.hash=t,this.version=Bitcoin.Address.networkVersion},Bitcoin.Address.networkVersion=30,Bitcoin.Address.prototype.toString=function(){var t=this.hash.slice(0);t.unshift(this.version);var e=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0}),i=t.concat(e.slice(0,4));return Bitcoin.Base58.encode(i)},Bitcoin.Address.prototype.getHashBase64=function(){return Crypto.util.bytesToBase64(this.hash)},Bitcoin.Address.decodeString=function(t){var e=Bitcoin.Base58.decode(t),i=e.slice(0,21),r=Crypto.SHA256(Crypto.SHA256(i,{asBytes:!0}),{asBytes:!0});if(r[0]!=e[21]||r[1]!=e[22]||r[2]!=e[23]||r[3]!=e[24])throw"Checksum validation failed!";var o=i.shift();if(0!=o)throw"Version "+o+" not supported!";return i},Bitcoin.ECDSA=function(){var t=EllipticCurve.getSECCurveByName("secp256k1"),e=new SecureRandom,i=null;var r={getBigRandom:function(t){return new BigInteger(t.bitLength(),e).mod(t.subtract(BigInteger.ONE)).add(BigInteger.ONE)},sign:function(e,i){var o=i,n=t.getN(),s=BigInteger.fromByteArrayUnsigned(e);do{var u=r.getBigRandom(n),h=t.getG().multiply(u).getX().toBigInteger().mod(n)}while(h.compareTo(BigInteger.ZERO)<=0);var a=u.modInverse(n).multiply(s.add(o.multiply(h))).mod(n);return r.serializeSig(h,a)},verify:function(e,i,o){var n,s,u;if(Bitcoin.Util.isArray(i)){var h=r.parseSig(i);n=h.r,s=h.s}else{if("object"!=typeof i||!i.r||!i.s)throw"Invalid value for signature";n=i.r,s=i.s}if(o instanceof ec.PointFp)u=o;else{if(!Bitcoin.Util.isArray(o))throw"Invalid format for pubkey value, must be byte array or ec.PointFp";u=EllipticCurve.PointFp.decodeFrom(t.getCurve(),o)}var a=BigInteger.fromByteArrayUnsigned(e);return r.verifyRaw(a,n,s,u)},verifyRaw:function(e,i,r,o){var n=t.getN(),s=t.getG();if(i.compareTo(BigInteger.ONE)<0||i.compareTo(n)>=0)return!1;if(r.compareTo(BigInteger.ONE)<0||r.compareTo(n)>=0)return!1;var u=r.modInverse(n),h=e.multiply(u).mod(n),a=i.multiply(u).mod(n);return s.multiply(h).add(o.multiply(a)).getX().toBigInteger().mod(n).equals(i)},serializeSig:function(t,e){var i=t.toByteArraySigned(),r=e.toByteArraySigned(),o=[];return o.push(2),o.push(i.length),(o=o.concat(i)).push(2),o.push(r.length),(o=o.concat(r)).unshift(o.length),o.unshift(48),o},parseSig:function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:BigInteger.fromByteArrayUnsigned(i),s:BigInteger.fromByteArrayUnsigned(r)}},parseSigCompact:function(e){if(65!==e.length)throw"Signature has the wrong length";var i=e[0]-27;if(i<0||i>7)throw"Invalid signature type";var r=t.getN();return{r:BigInteger.fromByteArrayUnsigned(e.slice(1,33)).mod(r),s:BigInteger.fromByteArrayUnsigned(e.slice(33,65)).mod(r),i:i}},recoverPubKey:function(e,o,n,s){var u=1&(s&=3),h=s>>1,a=t.getN(),p=t.getG(),f=t.getCurve(),c=f.getQ(),l=f.getA().toBigInteger(),g=f.getB().toBigInteger();i||(i=c.add(BigInteger.ONE).divide(BigInteger.valueOf(4)));var y=h?e.add(a):e,m=y.multiply(y).multiply(y).add(l.multiply(y)).add(g).mod(c).modPow(i,c),d=(m.isEven(),(m.isEven()?!u:u)?m:c.subtract(m)),v=new EllipticCurve.PointFp(f,f.fromBigInteger(y),f.fromBigInteger(d));v.validate();var B=BigInteger.fromByteArrayUnsigned(n),b=BigInteger.ZERO.subtract(B).mod(a),F=e.modInverse(a),T=function(t,e,i,r){for(var o=Math.max(e.bitLength(),r.bitLength()),n=t.add2D(i),s=t.curve.getInfinity(),u=o-1;u>=0;--u)(s=s.twice2D()).z=BigInteger.ONE,e.testBit(u)?s=r.testBit(u)?s.add2D(n):s.add2D(t):r.testBit(u)&&(s=s.add2D(i));return s}(v,o,p,b).multiply(F);if(T.validate(),!r.verifyRaw(B,e,o,T))throw"Pubkey recovery unsuccessful";var I=new Bitcoin.ECKey;return I.pub=T,I},calcPubkeyRecoveryParam:function(t,e,i,r){for(var o=0;o<4;o++)try{if(Bitcoin.ECDSA.recoverPubKey(e,i,r,o).getBitcoinAddress().toString()==t)return o}catch(t){}throw"Unable to find valid recovery factor"}};return r}(),Bitcoin.ECKey=function(){var t=Bitcoin.ECDSA,e=EllipticCurve.getSECCurveByName("secp256k1"),i=(new SecureRandom,function(r){if(r){if(r instanceof BigInteger)this.priv=r;else if(Bitcoin.Util.isArray(r))this.priv=BigInteger.fromByteArrayUnsigned(r);else if("string"==typeof r){var o=null;i.isWalletImportFormat(r)?(o=i.decodeWalletImportFormat(r),this.compressed=!1):i.isCompressedWalletImportFormat(r)?(o=i.decodeCompressedWalletImportFormat(r),this.compressed=!0):i.isMiniFormat(r)?o=Crypto.SHA256(r,{asBytes:!0}):i.isHexFormat(r)?o=Crypto.util.hexToBytes(r):i.isBase64Format(r)&&(o=Crypto.util.base64ToBytes(r)),null==o||32!=o.length?this.priv=null:this.priv=BigInteger.fromByteArrayUnsigned(o)}}else{var n=e.getN();this.priv=t.getBigRandom(n)}this.compressed=null==this.compressed?!!i.compressByDefault:this.compressed});return i.privateKeyPrefix=158,i.compressByDefault=!0,i.prototype.setCompressed=function(t){return this.compressed=!!t,this.pubPoint&&(this.pubPoint.compressed=this.compressed),this},i.prototype.getPub=function(){return this.compressed?this.pubComp?this.pubComp:this.pubComp=this.getPubPoint().getEncoded(1):this.pubUncomp?this.pubUncomp:this.pubUncomp=this.getPubPoint().getEncoded(0)},i.prototype.getPubPoint=function(){return this.pubPoint||(this.pubPoint=e.getG().multiply(this.priv),this.pubPoint.compressed=this.compressed),this.pubPoint},i.prototype.getPubKeyHex=function(){return this.compressed?this.pubKeyHexComp?this.pubKeyHexComp:this.pubKeyHexComp=Crypto.util.bytesToHex(this.getPub()).toString().toUpperCase():this.pubKeyHexUncomp?this.pubKeyHexUncomp:this.pubKeyHexUncomp=Crypto.util.bytesToHex(this.getPub()).toString().toUpperCase()},i.prototype.getPubKeyHash=function(){return this.compressed?this.pubKeyHashComp?this.pubKeyHashComp:this.pubKeyHashComp=Bitcoin.Util.sha256ripe160(this.getPub()):this.pubKeyHashUncomp?this.pubKeyHashUncomp:this.pubKeyHashUncomp=Bitcoin.Util.sha256ripe160(this.getPub())},i.prototype.getBitcoinAddress=function(){var t=this.getPubKeyHash();return new Bitcoin.Address(t).toString()},i.prototype.setPub=function(t){Bitcoin.Util.isArray(t)&&(t=Crypto.util.bytesToHex(t).toString().toUpperCase());var i=e.getCurve().decodePointHex(t);return this.setCompressed(i.compressed),this.pubPoint=i,this},i.prototype.getBitcoinWalletImportFormat=function(){var t=this.getBitcoinPrivateKeyByteArray();t.unshift(i.privateKeyPrefix),this.compressed&&t.push(1);var e=Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0});return t=t.concat(e.slice(0,4)),Bitcoin.Base58.encode(t)},i.prototype.getBitcoinHexFormat=function(){return Crypto.util.bytesToHex(this.getBitcoinPrivateKeyByteArray()).toString().toUpperCase()},i.prototype.getBitcoinBase64Format=function(){return Crypto.util.bytesToBase64(this.getBitcoinPrivateKeyByteArray())},i.prototype.getBitcoinPrivateKeyByteArray=function(){for(var t=this.priv.toByteArrayUnsigned();t.length<32;)t.unshift(0);return t},i.prototype.toString=function(t){return"base64"==(t=t||"").toString().toLowerCase()||"b64"==t.toString().toLowerCase()?this.getBitcoinBase64Format():"wif"==t.toString().toLowerCase()?this.getBitcoinWalletImportFormat():this.getBitcoinHexFormat()},i.prototype.sign=function(e){return t.sign(e,this.priv)},i.prototype.verify=function(e,i){return t.verify(e,i,this.getPub())},i.decodeWalletImportFormat=function(t){var e=Bitcoin.Base58.decode(t),r=e.slice(0,33),o=Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0});if(o[0]!=e[33]||o[1]!=e[34]||o[2]!=e[35]||o[3]!=e[36])throw"Checksum validation failed!";var n=r.shift();if(n!=i.privateKeyPrefix)throw"Version "+n+" not supported!";return r},i.decodeCompressedWalletImportFormat=function(t){var e=Bitcoin.Base58.decode(t),r=e.slice(0,34),o=Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0});if(o[0]!=e[34]||o[1]!=e[35]||o[2]!=e[36]||o[3]!=e[37])throw"Checksum validation failed!";var n=r.shift();if(n!=i.privateKeyPrefix)throw"Version "+n+" not supported!";return r.pop(),r},i.isHexFormat=function(t){return t=t.toString(),/^[A-Fa-f0-9]{64}$/.test(t)},i.isWalletImportFormat=function(t){return t=t.toString(),/^9[UVW][123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{49}$/.test(t)},i.isCompressedWalletImportFormat=function(t){return t=t.toString(),/^e[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{51}$/.test(t)},i.isBase64Format=function(t){return t=t.toString(),/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789=+\/]{44}$/.test(t)},i.isMiniFormat=function(t){t=t.toString();var e=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{21}$/.test(t),i=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{25}$/.test(t),r=/^S[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{29}$/.test(t),o=Crypto.SHA256(t+"?",{asBytes:!0});return(0===o[0]||1===o[0])&&(e||i||r)},i}(),Bitcoin.Util={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},makeFilledArray:function(t,e){for(var i=[],r=0;r<t;)i[r++]=e;return i},numToVarInt:function(t){return t<253?[t]:t<=65536?[253,t>>>8,255&t]:t<=1?[254].concat(Crypto.util.wordsToBytes([t])):[255].concat(Crypto.util.wordsToBytes([t>>>32,t]))},valueToBigInt:function(t){return t instanceof BigInteger?t:BigInteger.fromByteArrayUnsigned(t)},formatValue:function(t){for(var e=this.valueToBigInt(t).toString(),i=e.length>8?e.substr(0,e.length-8):"0",r=e.length>8?e.substr(e.length-8):e;r.length<8;)r="0"+r;for(r=r.replace(/0*$/,"");r.length<2;)r+="0";return i+"."+r},parseValue:function(t){for(var e=t.split("."),i=e[0],r=e[1]||"0";r.length<8;)r+="0";r=r.replace(/^0+/g,"");var o=BigInteger.valueOf(parseInt(i));return o=(o=o.multiply(BigInteger.valueOf(1e8))).add(BigInteger.valueOf(parseInt(r)))},sha256ripe160:function(t){return Crypto.RIPEMD160(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})},dsha256:function(t){return Crypto.SHA256(Crypto.SHA256(t,{asBytes:!0}),{asBytes:!0})}};var minikeychars="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",mini2key=function(t){return!!Bitcoin.ECKey.isMiniFormat(t)&&new Bitcoin.ECKey(t)};function buf2array(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}var candidate=function(){for(var t=["S"],e=BigInteger.valueOf(minikeychars.length),i=BigInteger.fromByteArrayUnsigned(buf2array(Crypto.util.randomBytes(50).slice(0)));t.length<30;){var r=i.divideAndRemainder(e);if(t.push(minikeychars.charAt(r[1])),(i=r[0]).compareTo(BigInteger.ONE)<=0)return console.log("Ran out of entropy with key only",t.length,"long"),!1}return t.join("")},genmini=function(){var t=document.getElementById("n").value,e=document.getElementById("keys");if(NaN!=parseInt(t))for(var i=0;i<t;){var r=candidate();if(!1!==r)if(0,0==Crypto.SHA256(r+"?")[0]&&Bitcoin.ECKey.isMiniFormat(r)){var o=new Bitcoin.ECKey(r);e.innerHTML+="<div class='row' style='background-color:#111;border-radius:15px;padding:20px;margin:15px;'><div class='col-md-6'>"+r+"</div><div class='col-md-6'>"+o.getBitcoinAddress()+"</div></div><br />",i++}}else alert("Please enter the number of Minikeys to generate")},selectRange=function(t){if(document.selection)(e=document.body.createTextRange()).moveToElementText(document.getElementById(t)),e.select();else if(window.getSelection){var e;(e=document.createRange()).selectNode(document.getElementById(t)),window.getSelection().addRange(e)}window.prompt("Copy to clipboard by using CTRL+C then Enter",e)};